angular.module("movieCat",["ngRoute","movieCat.route","commonModule","in_theatersModule","publicModule","searchModule","coming_soonMoudle"]),angular.module("commonModule",[]).controller("navCtrl",["$scope","$location",function(e,o){e.isActive="in_theaters",e.search=function(){var t=e.keyword;o.path("/search/"+t+"/1")}}]),angular.module("publicModule",[]).service("myService",[function(){this.url="https://api.douban.com",this.myJsonp=function(e,o,t){var n=document.createElement("script"),a="jsonp"+Math.random().toString().replace(".","");window[a]=function(e){t(e),document.body.removeChild(n),delete window[a]};var r="";for(var c in o)r+=c+"="+o[c]+"&";e=(e=e+"?"+r)+"callback="+a,n.src=e,document.body.appendChild(n)}}]),angular.module("movieCat.route",[]).config(["$routeProvider",function(e){e.when("/in_theaters/:page",{templateUrl:"./views/in_theaters/in_theaters.html",controller:"in_theatersCtrl"}).when("/coming_soon/:page",{templateUrl:"./views/coming_soon/coming_soon.html",controller:"coming_soonCtrl"}).when("/search/:keyword/:page",{templateUrl:"./views/search/search.html",controller:"searchCtrl"}).otherwise("/in_theaters/1")}]),angular.module("coming_soonMoudle",[]).controller("coming_soonCtrl",["$scope","myService","$location","$routeParams",function(e,o,t,n){var a=n.page,r=20*(a-1),c=0;o.myJsonp("https://api.douban.com/v2/movie/coming_soon",{count:20,start:r},function(o){e.result=o,e.$apply(),c=Math.ceil(o.total/20)}),e.changePage=function(e){"next"==e?++a>c&&(a=c):"prev"==e&&--a<1&&(a=1),t.path("/coming_soon/"+a)}}]),angular.module("in_theatersModule",[]).controller("in_theatersCtrl",["$scope","myService","$routeParams","$location",function(e,o,t,n){var a=t.page,r=10*(a-1),c=0;o.myJsonp("https://api.douban.com/v2/movie/in_theaters",{count:10,start:r},function(o){e.result=o,e.$apply(),c=Math.ceil(o.total/10)}),e.changePage=function(e){"next"==e?++a>c&&(a=c):"prev"==e&&--a<1&&(a=1),n.path("/in_theaters/"+a)}}]),angular.module("searchModule",[]).controller("searchCtrl",["$scope","myService","$routeParams","$location",function(e,o,t,n){var a=t.keyword,r=t.page,c=10*(r-1),l=0;o.myJsonp("https://api.douban.com/v2/movie/search",{q:a,count:10,start:c},function(o){console.log(o),e.result=o,e.$apply(),l=Math.ceil(o.total/10)}),e.changePage=function(e){"next"==e?++r>l&&(r=l):"prev"==e&&--r<1&&(r=1),n.path("/search/"+a+"/"+r)}}]);